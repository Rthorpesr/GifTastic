<!DOCTYPE html>
<html lang="en">

    <head>
    <meta charset="utf-8">
    <title>Reggie's Sports Giphy Page</title>

    <style type="text/css">
      button,
      div,
      form,
      input 
          {
            margin: 10px;
            float: right;
          }
    </style>
    </head>

    <body>  
          <div class="container">
              <h1>Sports Team Search</h1>
              <div id="buttons-view"></div>  <!-- Team buttons on page --->
              
              <form id="team-form">
                  <label for="team-input">Add a Team</label>
                  <input type="text" id="team-input"><br>

                  <!-- Button triggers new team button to be added -->
                  <input id="add-team" type="submit" value="click to add team"> 
              </form>
              <div id="gifs-appear-here"></div>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
          <script type="text/javascript">   
                // Initial array of teams
                var teams = ["redskins", "steelers", "capitals", "penguins", "wizards", "eagles", "flyers", "nationals", "giants", "cowboys", "bears", "lions"];

                // Function for displaying team data
                function renderButtons()
                {
                     // Deleting the team buttons prior to adding new team buttons
                     // (this is necessary otherwise we will have repeat buttons)
                     $("#buttons-view").empty();
              
                     // Looping through the array of teams
                     for (var i = 0; i < teams.length; i++) 
                        {
                           // Then dynamicaly generating buttons for each team in the array.
                           // This code $("<button>") is all jQuery needs to create the start and end tag. (<button></button>)
                           var a = $("<button>");
                           // Adding a class
                           a.addClass("team");
                           // Adding a data-attribute with a value of the team at index i
                           a.attr("data-name", teams[i]);
                           //console.log("1.)Reggie the team selected: " +teams[i]); -- Line used to debug.
                           // Providing the button's text with a value of the team at index i
                           a.text(teams[i]);
                           // Adding the button to the HTML
                           $("#buttons-view").append(a);
                           //console.log("The team just added: " +teams[i]); -- this line is used to debug.
                        }
                  };

                renderButtons();

                // Adding click event listen listener to all buttons
                 $("button").on("click", function() 
                      {
                        // Grabbing and storing the data-team property value from the button
                        var selectedTeam = $(this).attr("data-name");
                        console.log("2.)Reggie the team selected: " +selectedTeam);

                        //Setup the call to the API GIPHY WEB SITE
                        var api = "https://api.giphy.com/v1/gifs/search?q=";
                        var apikey = "&api_key=HkrCOrKlKGlWWszPPWXR15UK9zOEw8gU";
                        var returnTeam   = selectedTeam
                        var queryURL = api + returnTeam  + apikey;
                        var gLimits = "&limit=5"; 
                        var btn = $('<button>Click Me</button>').attr('id', 'btn1').attr('width', '200px')
                                                                .addClass('btn').attr('onclick', 'this.controller.ShowDialog()');                       
                        // When the above variable are loaded the URL will look like the example below where 
                        //(steelers is what might be stored in returnTeam, if that button was clicked.)
                        //https://api.giphy.com/v1/gifs/search?q=steelers&api_key=HkrCOrKlKGlWWszPPWXR15UK9zOEw8gU&limit=5

                        // Performing an AJAX request with the queryURL
                        $.ajax(
                           {
                              url: queryURL,
                              method: "GET"
                           })
      
                        // After data comes back from the request
                        .then(function(response) 
                             {
                                console.log(response);
                                var results = response.data;
                                console.log("results:" + response.data);

                                //Loop through all the gifs and display them (pre-appending)
                                for (var i=0; i < results.length; i++)
                                  { 
                                      console.log("array length: " + results.length);
                                      // Creating and storing a div tag
                                        var myTeamDiv = $("<div>");  
                                        
                                        // Creating a paragraph tag with the result item's rating
                                        var p = $("<p>").text(results[i].title);
                                                console.log("reggie's paragraph: " + results[i].title);
                                      // Creating and storing an image tag
                                        var tNameImage = $("<img>");
                                        //tNameImage.attr("src", results[i].url);
                                        console.log("tNameImage: " + tNameImage);
                                      // Setting the src attribute of the image to a property pulled off the result item
                                        tNameImage.attr("src", results[i].images.fixed_height.url);
                                          //btn.html(tName);
                                          myTeamDiv.append(btn);
                                          myTeamDiv.append(p);
                                          myTeamDiv.append(tNameImage);
                                      // results[i].images.fixed_height.url);
                                        var displayName = results[i].display_name;
                                        console.log("teamname: " +displayName);
                                        var profileURL = results[i].url;
                                        console.log("URL: " + results[i].url);
                                      
                                        console.log("i:" + i);
                                    
                                        $("#add-team").prepend(myTeamDiv); 

                                            // Prependng the animalDiv to the HTML page in the "#gifs-appear-here" div
                                        $("#gifs-appear-here").prepend(myTeamDiv); 
                                  }
                             })       
                      })
           
          </script>
          </div>
    </body>
</html>
         